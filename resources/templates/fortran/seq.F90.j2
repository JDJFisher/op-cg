
MODULE {{ kernel['kernel'] }}_module

USE OP2_FORTRAN_DECLARATIONS
USE OP2_FORTRAN_RT_SUPPORT
USE ISO_C_BINDING
USE OP2_CONSTANTS

CONTAINS

! Include kernel function
#include "{{ kernel['kernel'] }}.inc"



! Wrapper for kernel function
SUBROUTINE kernel ( & 
  {# TODO: Finish #}
  & bottom, &
  & top &
  & )

  implicit none

  
  INTEGER(kind=4) bottom,top,i1
  {# TODO: Finish #}


  DO i1 = bottom, top-1, 1
    {# TODO: Finish #}

    ! Kernel call
    call {{ kernel_name }}( &
      {% for action in kernel['actions'] %}
      & opDat{{ loop.index }}Local(1){{ '' if loop.last else ',' }} &     
      {% endfor %}
    & )

  END DO


END SUBROUTINE


! Host function for kernel
SUBROUTINE {{ kernel['kernel'] }}_host ( &
  & kernel, &
  & set, &
  {% for action in kernel['actions'] %}
  & opDat{{ loop.index }}{{ '' if loop.last else ',' }} &            
  {% endfor %}
  & )

  implicit none


  call op_mpi_set_dirtybit(numberOfOpDats,opArgArray)

  call op_timers_core(endTime)

  dataTransfer = 0.0'


END SUBROUTINE


END MODULE